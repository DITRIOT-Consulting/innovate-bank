def remote = [:]
remote.name = "node"
remote.host = "192.168.0.78"
remote.allowAnyHosts = true

node {
    checkout scm
    withCredentials([usernamePassword(credentialsId: 'administrator', passwordVariable: 'password', usernameVariable: 'userName')]) {
        remote.user = userName
        remote.password = password

        stage("Build") {
            sshCommand remote: remote, command: 'npm install'
        }
        stage("Test") {
            sshCommand remote: remote, command: 'npm test'
        }
        stage("Deploy") {
            sshCommand remote: remote, command: 'npm start'
        }
    }
}
